@model IEnumerable<CinemaProject.Models.Actor>

@{
    ViewBag.Title = "Actors Management";
}

<section class="py-3 filter-bar">
    <div class="container">
        <form method="get" class="row g-2">
            <div class="col-md-4">
                <input type="text" name="ActorName" class="form-control" placeholder="Actor Name" value="@ViewBag.ActorName">
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-dark w-100">Filter</button>
            </div>
        </form>
    </div>
</section>

<div class="container mt-4">
    <div class="row mb-3">
        <div class="col-md-6">
            <h2>All Actors</h2>
        </div>
        <div class="col-md-6 text-end">
            <a href="/Admin/Actor/Create" class="btn btn-success">Add Actor</a>
        </div>
    </div>

    <table class="table table-hover align-middle">
        <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Age</th>
                <th>Skills</th>
                <th>Image</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var actor in Model)
            {
                <tr>
                    <th>@actor.Id</th>
                    <td>@actor.Name</td>
                    <td>@actor.Age</td>
                    <td>@string.Join(", ", actor.Skills ?? new List<string>())</td>
                    <td>
                        @if (!string.IsNullOrEmpty(actor.Img))
                        {
                            <img src="~/images/actor_images/@actor.Img" alt="@actor.Name" style="width:60px;height:60px;object-fit:cover;" />
                        }
                    </td>
                    <td>
                        <a href="/Admin/Actor/Edit/@actor.Id" class="btn btn-warning btn-sm">Edit</a>
                        <a href="/Admin/Actor/Delete/@actor.Id" class="btn btn-danger btn-sm btn-delete">Delete</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <!-- Pagination -->
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            @if ((ViewBag.currentPage ?? 1) > 1)
            {
                <li class="page-item">
                    <a class="page-link" href="/Admin/Actor/Index?page=@((ViewBag.currentPage ?? 1) - 1)&ActorName=@ViewBag.ActorName">Previous</a>
                </li>
            }

            @for (var i = 1; i <= (ViewBag.totalNumberOfPages ?? 1); i++)
            {
                <li class="page-item @(i == (ViewBag.currentPage ?? 1) ? "active" : "")">
                    <a class="page-link" href="/Admin/Actor/Index?page=@i&ActorName=@ViewBag.ActorName">@i</a>
                </li>
            }

            @if ((ViewBag.currentPage ?? 1) < (ViewBag.totalNumberOfPages ?? 1))
            {
                <li class="page-item">
                    <a class="page-link" href="/Admin/Actor/Index?page=@((ViewBag.currentPage ?? 1) + 1)&ActorName=@ViewBag.ActorName">Next</a>
                </li>
            }
        </ul>
    </nav>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".btn-delete").forEach(button => {
            button.addEventListener("click", function (e) {
                e.preventDefault();
                const url = this.getAttribute("href");

                Swal.fire({
                    title: "Are you sure?",
                    text: "This action cannot be undone!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#d33",
                    cancelButtonColor: "#3085d6",
                    confirmButtonText: "Yes, delete it!"
                }).then(result => {
                    if (result.isConfirmed) {
                        window.location.href = url;
                    }
                });
            });
        });
    });
</script>
